---
output:
  pdf_document: default
  html_document: default
---
# Advent Of Code 2022

```{r, echo=FALSE, results='hide'}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
rm(list = ls())
```

```{r}
library(readr)
library(magrittr)
library(dplyr)
```

## Day 1

### Part 1

Find the Elf carrying the most Calories. How many total Calories is that Elf carrying?

```{r}
raw_data <- read_csv("day1.txt", col_names = FALSE, skip_empty_rows = FALSE)
```

```{r}
data = c()
cumsum = 0
for (v in raw_data$X1) {
  if (is.na(v)) {
    data <- append(data, cumsum)
    cumsum <- 0
  } else {
    cumsum <- cumsum + v
  }
}

max_cal <- 0
for (v in data) {
  if (v > max_cal) {
    max_cal <- v
  }
}

max_cal
```
### Part 2

Find the top three Elves carrying the most Calories. How many Calories are those Elves carrying in total?

```{r}
max_cals <- c(0, 0, 0)
for (v in data) {
  for (i in 1:3) {
    if (v > max_cals[i]) {
      min_index <- 1
      if (max_cals[2] < max_cals[min_index]) {
        min_index <- 2
      }
      if (max_cals[3] < max_cals[min_index]) {
        min_index <- 3
      }
      max_cals[min_index] <- v
      break
    }
  }
}

sum(max_cals)
```

## Day 2

### Part 1

What would your total score be if everything goes exactly according to your strategy guide?

```{r}
data <- read_delim("day2.txt", col_names = c("You", "Me"), delim = " ") %>%
  mutate(
    You = case_when(
      You == "A" ~ "R",
      You == "B" ~ "P",
      You == "C" ~ "S"
    ),
    Me = case_when(
      Me == "X" ~ "R",
      Me == "Y" ~ "P",
      Me == "Z" ~ "S"
    ),
    ShapeScore = case_when(
      Me == "R" ~ 1,
      Me == "P" ~ 2,
      Me == "S" ~ 3
    ),
    OutcomeScore = case_when(
      Me == You ~ 3,
      Me == "R" & You == "S" ~ 6,
      Me == "P" & You == "R" ~ 6,
      Me == "S" & You == "P" ~ 6,
      TRUE ~ 0
    ),
    Score = ShapeScore + OutcomeScore
  )

sum(data$Score)
```

Following the Elf's instructions for the second column, what would your total score be if everything goes exactly according to your strategy guide?

```{r}
data <- read_delim("day2.txt", col_names = c("You", "Outcome"), delim = " ") %>%
  mutate(
    You = case_when(
      You == "A" ~ "R",
      You == "B" ~ "P",
      You == "C" ~ "S"
    ),
    Outcome = case_when(
      Outcome == "X" ~ "Lose",
      Outcome == "Y" ~ "Draw",
      Outcome == "Z" ~ "Win"
    ),
    OutcomeScore = case_when(
      Outcome == "Lose" ~ 0,
      Outcome == "Draw" ~ 3,
      Outcome == "Win" ~ 6
    ),
    Me = case_when(
      Outcome == "Draw" ~ You,
      Outcome == "Win" & You == "R" ~ "P",
      Outcome == "Win" & You == "P" ~ "S",
      Outcome == "Win" & You == "S" ~ "R",
      Outcome == "Lose" & You == "R" ~ "S",
      Outcome == "Lose" & You == "P" ~ "R",
      Outcome == "Lose" & You == "S" ~ "P",
    ),
    ShapeScore = case_when(
      Me == "R" ~ 1,
      Me == "P" ~ 2,
      Me == "S" ~ 3
    ),
    Score = ShapeScore + OutcomeScore
  )

sum(data$Score)
```















